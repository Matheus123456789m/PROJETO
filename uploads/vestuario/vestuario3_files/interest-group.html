<!DOCTYPE html>
<!-- saved from url=(0287)https://fledge.us.criteo.com/interest-group?data=D0BcUXxmRVVIVFJSY0VTQUV0cEJNYjB0SlZGNEVUa214aUlsSlMvM01jOWdTSHowRmlFT2M0ME94Q0p4cDhQVk1lS0l1ZHJvRjluQ2dLYSt4Y0oyeURtN0lnSXMxVmpKNGkvZFQ4RzlKM3d1QUF1ZEE4eUFOdEtDMElaWUJ0SE5COG5CTFUvY0Q1TUZJV1JxY25Mc0Z3VDVJSm5KSGFqVmRuSWlsTnlsVXhoZi96ODg9fA -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
    <!-- Chrome origin trial token -->
    <meta http-equiv="origin-trial" content="AnolOEEMEnMaCvmUcw/eijaA/Ntx4pke43TW8O1+XFxTL7yMSzmBnkPrjQ33sKmqvREEpLQOE72gUMzHLu9KiAoAAABseyJvcmlnaW4iOiJodHRwczovL2NyaXRlby5jb206NDQzIiwiZmVhdHVyZSI6IlByaXZhY3lTYW5kYm94QWRzQVBJcyIsImV4cGlyeSI6MTY5NTE2Nzk5OSwiaXNTdWJkb21haW4iOnRydWV9">
    <title>Fledge IFrame</title>
</head>
<body>

<script>
    function getBswIg(src) {
        const elt = document.createElement("iframe");
        elt.allow = "join-ad-interest-group";
        elt.width = "0";
        elt.height = "0";
        elt.style.display = "none";
        elt.title = "BSW IG";
        elt.src = src;

        document.body.appendChild(elt);
    }

    if (!navigator.joinAdInterestGroup) {
        console.log("No fledge for you!");
    } else {
        var igs = [{"owner":"https://fledge.us.criteo.com","name":"2Z25HXxxNk93UHQ1a1lKZUY5TURKUEFJVXBnPT18","lifetimeMs":2592000000,"priorityVector":{"browserSignals.ageInMinutes":-1,"browserSignals.one":86400},"biddingLogicURL":"https://fledge.us.criteo.com/simplebid?platform=us","biddingWasmHelperURL":"https://fledge.us.criteo.com/criteo.wasm","trustedBiddingSignalsURL":"https://fledge.us.criteo.com/getvalues","trustedBiddingSignalsKeys":["fMHhmXxVdTc1Wkcxa0w5c3grU2tuY1htSmFtOXIrdHpENldxek5TNCtvNWdPZWRLM1RST01FWGYxUnAwYkRTR1BBalNEaVdIQWNpN3FRY2gzNEhPQ1FIRmZNWWc5THRGV0RIb2VUQUkyYzhReXFTekFNSGZhVCtGd3FYUkNmanVDZjhrNnQ2ck5pc21MRmRxNVpoRkxvRmdQTmRrTkg5Tlh0ZWU3VXJ5YkdpYzdUSlk9fA"],"maxTrustedBiddingSignalsURLLength":32768,"userBiddingSignals":{},"updateURL":"https://fledge.us.criteo.com/interest-group/update?key=dlieCnxoYWRPQ3lVQzVISEdwYXJvTjdWc1U3WkgyV1ZqclF3SzY4U3ZBU29FQVpTMSt1K2NXTmZVQXJkZ0hJa0d1aUV3ZDNLT2QvajFvRmF0TzZtTnNCVHBSUllZMjZjejZOeENWUllsZWxRbmowK0Ftdy9mOHVweWVFNWF6Ulc4bzJvSzFjSUMxUE9ScG1kWS9pNkxZTU5sWmc9PXw","ads":[{"renderURL":"https://ads.us.criteo.com/ad?pltd=False&campaignId=344851&adId=1652474&width=${AD_WIDTH}&height=${AD_HEIGHT}","metadata":{"data":"CJOGFRD67WQYASjBFDoA"}},{"renderURL":"https://${seller_native_url}/?${seller_native_query_params}https%3a%2f%2fads.us.criteo.com%2fnative%2fasset%3fcampaignId%3d344851%26adId%3d1635224&bn=criteo","metadata":{"data":"CJOGFRCY52MYAijBFDAH"}},{"renderURL":"https://ads.us.criteo.com/ad?pltd=False&campaignId=350719&adId=1652473&width=${AD_WIDTH}&height=${AD_HEIGHT}","metadata":{"data":"CP+zFRD57WQYASjBFDoA"}},{"renderURL":"https://${seller_native_url}/?${seller_native_query_params}https%3a%2f%2fads.us.criteo.com%2fnative%2fasset%3fcampaignId%3d350719%26adId%3d1635226&bn=criteo","metadata":{"data":"CP+zFRCa52MYAijBFDAH"}},{"renderURL":"https://ads.us.criteo.com/ad?pltd=False&campaignId=376560&adId=1652588&width=${AD_WIDTH}&height=${AD_HEIGHT}","metadata":{"data":"CPD9FhDs7mQYASjBFDoA"}},{"renderURL":"https://${seller_native_url}/?${seller_native_query_params}https%3a%2f%2fads.us.criteo.com%2fnative%2fasset%3fcampaignId%3d376560%26adId%3d1635228&bn=criteo","metadata":{"data":"CPD9FhCc52MYAijBFDAH"}},{"renderURL":"https://ads.us.criteo.com/ad?pltd=False&campaignId=379732&adId=1652471&width=${AD_WIDTH}&height=${AD_HEIGHT}","metadata":{"data":"CNSWFxD37WQYASjBFDoA"}},{"renderURL":"https://${seller_native_url}/?${seller_native_query_params}https%3a%2f%2fads.us.criteo.com%2fnative%2fasset%3fcampaignId%3d379732%26adId%3d1635230&bn=criteo","metadata":{"data":"CNSWFxCe52MYAijBFDAH"}}],"adComponents":[],"trustedBiddingSignalsSlotSizeMode":"slot-size","executionMode":"group-by-origin","sellerCapabilities":{"*":["interest-group-counts","latency-stats"]}}];
        var expiration = 2592000;
        var errorEndpoint = "https://fledge.us.criteo.com/interest-group/error?pid=2625";
        if (navigator.joinAdInterestGroup.length == 1) {
            for (const ig of igs) {
                navigator.joinAdInterestGroup(ig).catch((e) => fetch(`${errorEndpoint}&message=${encodeError(e)}`));
            }
        } else {
            // This is for backwards-compatibility
            // The 1 - arg implementation is future - proof
            for (const ig of igs) {
                navigator.joinAdInterestGroup(ig, expiration).catch((e) => fetch(`${errorEndpoint}&message=${encodeError(e)}`));
            }
        }
        if (false) {
            getBswIg("https://dsp-paapi-sandbox.bsw-ig.criteo.com/paapi/trade/dsp/html/index");
            getBswIg("https://paa-proxy-dsp.bsw-sb.criteo.com/paapi/paa-proxy/dsp/html/index/bsw-sb-ig-paa-proxy");
        }

        if (false) {
            callAuction();
        }
    }

    function encodeError(error) {
        return encodeURIComponent(error.name + ':' + error.message);
    }

    async function callAuction() {
        const owner = "https://fledge.us.criteo.com";

        const sellerJsUrl = `${owner}/interest-group/seller-js`;
        const response = await fetch(`${owner}/debug/test-signals?egid=11111`);
        const pbs = await response.json();

        const componentAuctionConf = {
            seller: owner,
            decisionLogicURL: sellerJsUrl,
            interestGroupBuyers: [owner],
            perBuyerSignals: pbs,
            perBuyerCumulativeTimeouts: {[owner]: 4000},
            perBuyerExperimentGroupIds: {[owner]: 11111},
            reportingTimeout: 5000 // max possible timeout (default 50)
        };

        const topAuctionConf = {
            seller: owner,
            decisionLogicURL: sellerJsUrl,
            componentAuctions: [componentAuctionConf]
        };

        const result = await navigator.runAdAuction(topAuctionConf);
    }

    async function measureAudienceSize() {
        // Measuring audience size
        // Register worklet
        if((!window?.sharedStorage?.worklet?.addModule) || (!window?.sharedStorage?.run)){
            return;
        }
        await window.sharedStorage.worklet.addModule('');

        // Run audience size measurement operation
        await window.sharedStorage.run('audience-size-measurement', {
            data: { bucketKey: BigInt('84004'), contributionValue: 8192}
        });
    }

    //TODO reactivate audience-size-measurement
    //measureAudienceSize();

</script>


</body></html>